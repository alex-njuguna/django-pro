{% extends 'base.xhtml' %}

{% load crispy_forms_tags %}

{% block content%}
    <h1 class="text-danger mb-3 text-capitalize">{{ post.title }}</h1>
    <hr>
    <p class="text-primary fs-5">
        Published {{ post.publish }} by {{ post.author}}
    </p>
    <hr>
    {{ post.body|linebreaks }}
    <p>
        <a href="{% url 'blog:post_share' post.id %}" class="mt-4 text-decoration-none btn btn-info">
            <i class="fa-solid fa-share fa-lg"></i>
        </a>
    </p>
    {% with comments.count as total_comments %}
        <h2 class="alert alert-info">
            {{ total_comments }} comment{{ total_comments|pluralize }}
        </h2>
    {% endwith %}

    {% for comment in comments %}
        <div class="mb-2 shadow p-2">
            <p class="text-primary fs-5 border-bottom">
                {{ comment.name }} on {{ comment.created }}
            </p>
            {{ comment.body|linebreaks }}
        </div>
        <hr class="text-danger fw-bold">
    {% empty %}
        <p class="alert alert-danger">No comments.</p>
    {% endfor %}
    
    <h2>Add a Comment</h2>
    <form method="post" class="mt-4 mb-4">
        {% csrf_token %}
        {{ form|crispy }}
        <input type="submit" value="Comment" class="btn btn-primary mt-3">
    </form>

    <hr>

    <h2 class="my-4 fw-bold">Similar Posts</h2>
    {% for post in similar_posts %}
    <div class="border-bottom shadow-sm p-3">
        <h5 >
            <a href="{{ post.get_absolute_url }}" class="text-decoration-none" style="color: brown;"> {{ post.title }} </a>
        </h5>
        <p>{{ post.body|truncatewords:10|linebreaks }}</p>
    </div>
    {% empty %}
        <p class="alert alert-danger">There are no similar posts yet</p>
    {% endfor %}
{% endblock %}
